High-performance templated sort functions.

